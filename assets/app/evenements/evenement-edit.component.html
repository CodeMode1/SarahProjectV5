<div class="alert alert-success col-md-12" role="alert" *ngIf="this.sauvegardeEvenement">
    <p>Évènement Sauvegardé: {{this.myEvenement.nom}}</p>
</div>
<section class="col-md-12 space">
    <form [formGroup]="editEvenementForm" (ngSubmit)="onSubmit()">
        <section class="col-md-12">
            <div class="col-md-4 form-group">
                <div class="col-md-12 outer">
                    <label for="nom">Nom</label>
                    <input type="text" id="nom" class="form-control" formControlName="nom" placeholder="name" [(ngModel)]="this.myEvenement.nom"
                        (ngModelChange)="onUserChange($event)">
                </div>
                <div class="col-md-12 outer">
                    <label for="dateEvenement">Date Évènement</label>
                    <input type="date" id="dateEvenement" class="form-control" formControlName="dateEvenement" placeholder="event date" [(ngModel)]="this.myEvenement.dateEvenement"
                        (ngModelChange)="onUserChange($event)">
                </div>
                <div class="col-md-12 outer">
                    <label for="contact">Contact</label>
                    <input type="text" id="contact" class="form-control" formControlName="contact" placeholder="contact" [(ngModel)]="this.myEvenement.contact"
                        (ngModelChange)="onUserChange($event)">
                </div>
                <div class="col-md-12 outer">
                    <label for="client">Client</label>
                    <div class="input-group col-md-12">
                        <span class="input-group-addon" aria-hidden="true" id="searchClient"><a (click)="getClients()" data-toggle="modal" data-target="#modalClient" data-backdrop="static" data-keyboard="false" id="boutonSearchNoContrat" class="glyphicon glyphicon-search"></a>
                        </span>
                        <input type="text" id="client" class="form-control" formControlName="client" placeholder="client" [(ngModel)]="this.myEvenement.client"
                            (ngModelChange)="onUserChange($event)" readonly>
                    </div>
                </div>
            </div>
            <div class="col-md-2 form-group">
                <div class="col-md-12 outer">
                    <label for="selectEtat">État</label>
                    <select class="form-control" id="selectEtat" formControlName="selectEtat" [(ngModel)]="this.myEvenement.selectEtat" (ngModelChange)="onUserChange($event)">
                            <option>Soumission</option>
                            <option>Non Retenu</option>
                            <option>Confirmation</option>
                            <option>Annulation</option>
                            <option>Facturation</option>
                            <option>Non Facturable</option>
                        </select>
                </div>
                <div class="col-md-6 floatLeftDate">
                    <label for="dateSoumission">Date Soumission</label>
                    <input type="date" id="dateSoumission" class="form-control" formControlName="dateSoumission" placeholder="submission date"
                        [(ngModel)]="this.myEvenement.dateSoumission" (ngModelChange)="onUserChange($event)">
                </div>
                <div class="col-md-6 floatLeftDate">
                    <label for="dateConfirmation">Date Confirmation</label>
                    <input type="date" id="dateConfirmation" class="form-control" formControlName="dateConfirmation" placeholder="confirmation date"
                        [(ngModel)]="this.myEvenement.dateConfirmation" (ngModelChange)="onUserChange($event)">
                </div>
                <div class="col-md-6 clearDate">
                    <label for="dateFacturation">Date Facturation</label>
                    <input type="date" id="dateFacturation" class="form-control" formControlName="dateFacturation" placeholder="facturation date"
                        [(ngModel)]="this.myEvenement.dateFacturation" (ngModelChange)="onUserChange($event)">
                </div>
                <div class="col-md-6 floatLeftDate">
                    <label for="dateNonRetenu">Date Non Retenu</label>
                    <input type="date" id="dateNonRetenu" class="form-control" formControlName="dateNonRetenu" placeholder="unkept date" [(ngModel)]="this.myEvenement.dateNonRetenu"
                        (ngModelChange)="onUserChange($event)">
                </div>
                <div class="col-md-12 clearDate">
                    <label for="dateAnnulation">Date Annulation</label>
                    <input type="date" id="dateAnnulation" class="form-control" formControlName="dateAnnulation" placeholder="annulation date"
                        [(ngModel)]="this.myEvenement.dateAnnulation" (ngModelChange)="onUserChange($event)">
                </div>
            </div>
            <div class="col-md-6 form-group">
                <div class="col-md-6">
                    <div class="col-md-12" class="notes">
                        <label for="notes">Notes</label>
                        <textarea maxlength="140" id="notes" class="form-control" rows="10" formControlName="notes" [(ngModel)]="this.myEvenement.notes"
                            (ngModelChange)="onUserChange($event)"></textarea>
                    </div>
                </div>
                <div class="col-md-6 form-group">
                    <div class="col-md-6 checkbox">
                        <label><input type="checkbox" value="" id="validationTache" formControlName="validationTache" [(ngModel)]="this.myEvenement.validationTache" (ngModelChange)="onUserChange($event)">Validation Tâche</label>
                    </div>
                    <div class="col-md-6">
                        <label>Numéro</label>
                        <input type="text" id="noEvenement" class="form-control" formControlName="noEvenement" [(ngModel)]="this.myEvenement.noEvenement"
                            readonly>
                    </div>
                    <div class="col-md-6 outer">
                        <label>Créé par</label>
                        <input type="text" id="creerPar" class="form-control" formControlName="creerPar" readonly [(ngModel)]="this.myEvenement.creerPar">
                        <label>Créé</label>
                        <input type="text" id="cree" class="form-control" formControlName="dateCree" readonly [(ngModel)]="this.myEvenement.dateCree">
                    </div>
                    <div class="col-md-6">
                        <label>Modifié par</label>
                        <input type="text" id="modifPar" class="form-control" formControlName="modifPar" readonly [(ngModel)]="this.myEvenement.modifPar">
                        <label>Modifié</label>
                        <input type="text" id="modifPar" class="form-control" formControlName="modif" readonly [(ngModel)]="this.myEvenement.modif">
                    </div>
                    <input type="text" id="client_FK" formControlName="client_FK" [(ngModel)]="this.myEvenement.client_FK" [hidden]="hiddenFK">
                </div>
            </div>
        </section>
        <my-activite-list [activites]="this.myEvenement.activites" [estNouveau]="this.estNouveau" (boutonChanges)="boutonSwitch($event)"
            [ressources]="this.ressources"></my-activite-list>
        <div class="col-md-12 footer space">
            <div class="col-md-4 divFooter">
                <button type="button" class="btn btn-primary" [disabled]="!formActualiser" (click)="actualiserEvx()">
                        <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span>
                        Actualiser
                    </button>
            </div>
            <div class="col-md-4 divFooter">
                <button type="submit" class="btn btn-primary" [disabled]="!editEvenementForm.valid || !modeSoumission">
                        <span class="glyphicon glyphicon-floppy-disk" aria-hidden="true"></span>
                        Enregistrer
                    </button>
            </div>
            <div class="col-md-4 divFooter">
                <button type="button" class="btn btn-primary" [disabled]="!formCopie" (click)="copieCetEvx()">
                        <span class="glyphicon glyphicon-print" aria-hidden="true"></span>
                        Copie Client
                    </button>
            </div>
        </div>
    </form>
    <div id="modalClient" class="modal fade" role="dialog">
        <div class="modal-dialog modal-lg">
            <!-- modal content -->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">Sélectionnez un client</h4>
                </div>
                <div class="modal-body">
                    <div class="table-responsive">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Nom</th>
                                    <th>Prénom</th>
                                    <th>Compagnie</th>
                                    <th>Tel.Principal</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let client of clients; let i=index" (click)="clientSelect(client)" [class.estSelectRange]="this.noClientSelectedList == client.noClient">
                                    <td>{{client?.nom}}</td>
                                    <td>{{client?.prenom}}</td>
                                    <td>{{client?.compagnie}}</td>
                                    <td>{{client?.telPrincipal}}</td>
                                </tr>
                                <tr *ngIf="!clients || !clients.length">
                                    <td class="bg-danger" colspan="5">Aucuns clients</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                        <p *ngIf="!clientSelectedList" class="styleClientSelected">Sélectionné : </p>
                        <div [ngSwitch]="aucunPrenomClientSelected">
                            <p *ngSwitchCase="true" class="styleClientSelected">Sélectionné : {{clientSelectedList?.nom}}</p>
                            <p *ngSwitchCase="false" class="styleClientSelected">Sélectionné : {{clientSelectedList?.nom}}, {{clientSelectedList?.prenom}}</p>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" id="boutonModalOk" data-dismiss="modal" (click)="saveClientSelected()">OK</button>
                    <button type="button" class="btn btn-default" data-dismiss="modal" (click)="deleteClientSelected()">Annuler</button>
                </div>
            </div>
        </div>
    </div>
</section>